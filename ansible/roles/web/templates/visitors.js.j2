document.addEventListener("DOMContentLoaded", function () {

  fetch("api/websites/stats", {
    headers: { Accept: "application/json" },
    cache: "no-store"
  })
    .then(function (res) {
      if (!res.ok) throw new Error("Bad response");
      return res.json();
    })
    .then(function (data) {

      console.log("Umami stats:", data);

      var value =
        data && typeof data.pageviews === "number"
          ? data.pageviews
          : 0;

      var el = document.getElementById("visitor-count");
      if (el) el.textContent = "Views: " + value;
    })
    .catch(function () {
      var el = document.getElementById("visitor-count");
      if (el) el.textContent = "Views: 0";
    });

});
